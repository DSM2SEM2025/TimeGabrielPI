create database recriandoProcedures;
use recriandoProcedures;

		#TABELA USUARIO
create table IF NOT EXISTS USUARIO(
	ID_USUARIO INT AUTO_INCREMENT PRIMARY KEY NOT NULL, 
    NOME_USUARIO VARCHAR(255),
    EMAIL_USUARIO VARCHAR(255) NOT NULL UNIQUE,
    SENHA_USUARIO VARCHAR(255) NOT NULL,
    TIPO_CONTA INT,
    DATA_CADASTRO DATE DEFAULT NULL,
    DATA_ATUALIZACAO DATE DEFAULT NULL,
    CONSTRAINT CHK_SENHA_TAMANHO CHECK (LENGTH(SENHA_USUARIO) >= 3),
    CONSTRAINT CHK_TIPO_CONTA CHECK (TIPO_CONTA IN (1, 2, 3))
);
--		#TABELA ESTOQUE
CREATE TABLE IF NOT EXISTS ESTOQUE (
	ID_ESTOQUE INT AUTO_INCREMENT PRIMARY KEY,
    TIPO_ESTOQUE VARCHAR(255) NOT NULL,
--    FK_ID_PRODUTO INT,
    QTDE INT not null,
    FOREIGN KEY (FK_ID_PRODUTO) REFERENCES Produto(ID_PRODUTO) on delete cascade
);
--		#TABELA PRODUTO
create table IF NOT EXISTS PRODUTO(
	ID_PRODUTO INT AUTO_INCREMENT PRIMARY key,
    NOME_PRODUTO VARCHAR(255) NOT NULL,
    PRECO_PRODUTO FLOAT NOT NULL,
    FK_ID_ESTOQUE INT DEFAULT NULL,
	DESC_PRODUTO VARCHAR(255) NULL
    FOREIGN KEY (FK_ID_ESTOQUE) REFERENCES ESTOQUE(ID_ESTOQUE) ON DELETE SET NULL
);
/*obs: Não sei se devia ter um parametro do tipo: código de barra, já que ele tem um metodo chamado: "cadastra_via_nota_discal, eu acho?"
	Não adicionei pq n tava no diagrama, mas dá pra alterar
*/



		#TABELA
        
CREATE TABLE IF NOT EXISTS MOVIMENTACAO(
	ID_MOVIMENTACAO INT AUTO_INCREMENT PRIMARY KEY NOT NULL,
	FK_ID_PRODUTO INT NOT NULL,
    QTDE INT NOT NULL, 
    TIPO_MOVIMENTACAO VARCHAR(255) NOT NULL,
    DATA_MOVIMENTACAO DATE NOT NULL,
    FOREIGN KEY (FK_ID_PRODUTO) REFERENCES PRODUTO(ID_PRODUTO)
);

	#TABELA PEDIDO ESTOQUE
create table IF NOT EXISTS PEDIDO_ENTREGA (
	id_entrega int auto_increment primary key not null,
	status_entrega boolean default FALSE,
    fk_id_produto int, 
    fk_ID_MOVIMENTACAO int, 
    foreign key (fk_id_produto) references PRODUTO(ID_PRODUTO),
    foreign key (fk_ID_MOVIMENTACAO) references MOVIMENTACAO(ID_MOVIMENTACAO)
    
);


